# üê≥ Dockerfile Lab ‚Äî FastAPI + Best Practices

## üìå –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
- app/ ‚Äî FastAPI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (Hello, ITMO!)
- docker_bad ‚Äî –ø—Ä–∏–º–µ—Ä –ø–ª–æ—Ö–æ–≥–æ Dockerfile
- docker_good ‚Äî —É–ª—É—á—à–µ–Ω–Ω—ã–π Dockerfile —Å best practices
- requirements.txt ‚Äî –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## ‚ùå –ü–ª–æ—Ö–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤ bad/Dockerfile

–ü—Ä–æ–±–ª–µ–º–∞ -> –ü–æ—á–µ–º—É –ø–ª–æ—Ö–æ -> –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
1) –ë–æ–ª—å—à–æ–π –æ–±—Ä–∞–∑ (python:3.10) -> –ë–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä, –ª–∏—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ -> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω python:3.10-slim
2) –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–Ω—É–∂–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ (vim, nano, git) -> –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å–ª–æ—è, –ª–∏—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ -> –¢–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π curl
3) COPY . /app -> –í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–µ—Ç –ø–æ–ø–∞—Å—Ç—å –ª–∏—à–Ω–µ–µ -> –ö–æ–ø–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ ./app
4) pip install –±–µ–∑ —Ñ–ª–∞–≥–æ–≤ -> –ó–∞–Ω–∏–º–∞–µ—Ç –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏ -> –î–æ–±–∞–≤–ª–µ–Ω --no-cache-dir, pip upgrade
5) –ù–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—ã -> –ú–æ–≥—É—Ç –±—ã—Ç—å –ª–∏—à–Ω–∏–µ –±–∞–π—Ç-–∫–æ–¥—ã, –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è -> –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã ENV –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

---

##  bad-practices –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

1. –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –æ—Ç root –±–µ–∑ USER ‚Äî –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ.
2. –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –±–µ–∑ volume ‚Äî –ø—Ä–∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–µ –≤—Å—ë —Ç–µ—Ä—è–µ—Ç—Å—è.

---

## –•–æ—Ä–æ—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤ good/Dockerfile

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑ python:3.10-slim, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –º–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä, –±—ã—Å—Ç—Ä–µ–µ —Å–±–æ—Ä–∫–∞, –º–µ–Ω—å—à–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.
–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–∞–∫–µ—Ç—ã + –æ—á–∏—â–µ–Ω –∫—ç—à APT, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —É–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–µ–≥–æ –ü–û –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —Å–Ω–∏–∂–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∏ –ø–æ–≤—ã—à–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.
–ö–æ–ø–∏—Ä—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã + —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –±–µ–∑ –∫—ç—à–∞, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–∑ —á–∏—â–µ, –Ω–µ—Ç –º—É—Å–æ—Ä–∞, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ ‚Äî –±—ã—Å—Ç—Ä–µ–µ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–µ–µ.

## –ö–∞–∫ —Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å

```bash
# –°–±–æ—Ä–∫–∞ —Ö–æ—Ä–æ—à–µ–≥–æ –æ–±—Ä–∞–∑–∞
docker build -t fastapi-itmo -f docker_good.

# –ó–∞–ø—É—Å–∫
docker run -d -p 8000:8000 -v $(pwd)/data:/app/data fastapi-itmo
